<?php include("include_header.php");?>
<main class="cd-main-content">
		<div class="cd-scrolling-bg cd-color-2">
			<div class="cd-container">
<?php

include("connect.php");
require_once("common.php");

if(isset($_GET['vol'])){$volume = $_GET['vol'];}else{$volume = '';}
if(isset($_GET['part'])){$part = $_GET['part'];}else{$part = '';}
$issue_array = array("000;00", "001;01", "001;02", "001;03", "001;04", "001;05", "001;06", "001;07", "001;08", "001;09", "001;10", "001;11", "001;12", "002;01", "002;02", "002;03", "002;04", "002;05", "002;06", "002;07", "002;08", "002;09", "002;10", "002;11", "002;12", "003;01", "003;02", "003;03", "003;04", "003;05", "003;06", "003;07", "003;08", "003;09", "003;10", "003;11-12", "004;01", "004;02-03", "004;04", "004;05", "004;06", "004;07", "004;08", "004;09", "004;10-11", "004;12", "005;01", "005;02", "005;03", "005;04", "005;05", "005;06", "005;07-08", "005;09", "005;10", "005;11-12", "006;01", "006;02", "006;03", "006;04", "006;05", "006;06", "006;07", "006;08", "006;09-10", "006;11", "006;12", "007;01", "007;02-03", "007;04", "007;05", "007;06", "007;07", "007;08", "007;09", "007;10", "007;11", "007;12", "008;01", "008;02", "008;03", "008;04", "008;05", "008;06", "008;07", "008;08", "008;09", "008;10", "008;11", "008;12", "009;01", "009;02", "009;03", "009;04", "009;05", "009;06-07", "009;08", "009;09-10", "009;11", "009;12", "010;01", "010;02", "010;03", "010;04", "010;05", "010;06", "010;07", "010;08", "010;09", "010;10", "010;11", "010;12", "011;01", "011;02", "011;03", "011;04", "011;05", "011;06", "011;07", "011;08", "011;09", "011;10", "011;11", "011;12", "012;01", "012;02", "012;03", "012;04", "012;05", "012;06", "012;07", "012;08", "012;09-10", "012;11", "012;12", "013;01", "013;02", "013;03", "013;04", "013;05", "013;06-07", "013;08", "013;09", "013;10", "013;11", "013;12", "014;01", "014;02", "014;03", "014;04", "014;05", "014;06", "014;07", "014;08", "014;09", "014;10", "014;11", "014;12", "015;01", "015;02", "015;03", "015;04", "015;05", "015;06", "015;07", "015;08", "015;09", "015;10", "015;11", "015;12", "016;01", "016;02", "016;03", "016;04", "016;05", "016;06", "016;07", "016;08", "016;09", "016;10", "016;11", "016;12", "017;01", "017;02", "017;03", "017;04", "017;05", "017;06", "017;07", "017;08", "017;09", "017;10", "017;11", "017;12", "018;01", "018;02", "018;03", "018;04", "018;05", "018;06", "018;07", "018;08", "018;09", "018;10", "018;11", "018;12", "019;01", "019;02", "019;03", "019;04", "019;05", "019;06", "019;07", "019;08", "019;09", "019;10", "019;11", "019;12", "020;01", "020;02", "020;03", "020;04", "020;05", "020;06", "020;07", "020;08", "020;09", "020;10", "020;11", "020;12", "021;01", "021;02", "021;03", "021;04", "021;05", "021;06", "021;07", "021;08", "021;09", "021;10", "021;11", "021;12", "022;01", "022;02", "022;03", "022;04", "022;05", "022;06", "022;07", "022;08", "022;09", "022;10-11", "022;12", "023;01", "023;02", "023;03", "023;04", "023;05", "023;06", "023;07", "023;08", "023;09", "023;10", "023;11", "023;12", "024;01", "024;02", "024;03", "024;04", "024;05", "024;06", "024;07", "024;08", "024;09", "024;10", "024;11", "024;12", "025;01", "025;02", "025;03", "025;04", "025;05", "025;06", "025;07", "025;08", "025;09", "025;10", "025;11", "025;12", "026;01", "026;02", "026;03", "026;04", "026;05", "026;06", "026;07", "026;08", "026;09", "026;10", "026;11", "026;12", "027;01", "027;02", "027;03", "027;04", "027;05", "027;06", "027;07", "027;08", "027;09", "027;10", "027;11", "027;12", "028;01", "028;02", "028;03", "028;04", "028;05", "028;06", "028;07", "028;08", "028;09", "028;10", "028;11", "028;12", "029;01", "029;02", "029;03", "029;04", "029;05", "029;06", "029;07", "029;08", "029;09", "029;10", "029;11", "029;12", "030;01", "030;02", "030;03", "030;04", "030;05", "030;06", "030;07", "030;08", "030;09", "030;10", "030;11", "030;12", "031;01", "031;02", "031;03", "031;04", "031;05", "031;06", "031;07", "031;08", "031;09", "031;10", "031;11", "031;12", "032;01", "032;02", "032;03", "032;04", "032;05", "032;06", "032;07", "032;08", "032;09", "032;10", "032;11", "032;12", "033;01", "033;02", "033;03", "033;04", "033;05", "033;06", "033;07", "033;08", "033;09", "033;10", "033;11", "033;12", "034;01", "034;02", "034;03", "034;04", "034;05", "034;06", "034;07", "034;08", "034;09", "034;10", "034;11", "034;12", "035;01", "035;02", "035;03", "035;04", "035;05", "035;06", "035;07", "035;08", "035;09", "035;10", "035;11", "035;12", "036;01", "036;02", "036;03", "036;04", "036;05", "036;06", "036;07", "036;08", "036;09", "036;10", "036;11", "036;12", "037;01", "037;02", "037;03", "037;04", "037;05", "037;06", "037;07", "037;08", "037;09", "037;10", "037;11", "037;12", "038;01", "038;02", "038;03", "038;04", "038;05", "038;06", "038;07", "038;08", "038;09", "038;10", "038;11", "038;12", "039;01", "039;02", "039;03", "039;04", "039;05", "039;06", "039;07", "039;08", "039;09", "039;10", "039;11", "039;12", "040;01", "040;02", "040;03", "040;04", "040;05", "040;06", "040;07", "040;08", "040;09", "040;10", "040;11", "040;12", "041;01", "041;02", "041;03", "041;04", "041;05", "041;06", "041;07", "041;08", "041;09", "041;10", "041;11", "041;12", "042;01", "042;02", "042;03", "042;04", "042;05", "042;06", "042;07", "042;08", "042;09", "042;10", "042;11", "042;12", "043;01", "043;02", "043;03", "043;04", "043;05", "043;06", "043;07", "043;08", "043;09", "043;10", "043;11", "043;12", "044;01", "044;02", "044;03", "044;04", "044;05", "044;06", "044;07", "044;08", "044;09", "044;10", "044;11", "044;12", "045;01", "045;02", "045;03", "045;04", "045;05", "045;06", "045;07", "045;08", "045;09", "045;10", "045;11", "045;12", "046;01", "046;02", "046;03", "046;04", "046;05", "046;06", "046;07", "046;08", "046;09", "046;10", "046;11", "046;12", "047;01", "047;02", "047;03", "047;04", "047;05", "047;06", "047;07", "047;08", "047;09", "047;10", "047;11", "047;12", "048;01", "048;02", "048;03", "048;04", "048;05", "048;06", "048;07", "048;08", "048;09", "048;10", "048;11", "048;12", "049;01", "049;02", "049;03", "049;04", "049;05", "049;06", "049;07", "049;08", "049;09", "049;10", "049;11", "049;12", "050;01", "050;02", "050;03", "050;04", "050;05", "050;06", "050;07", "050;08", "050;09", "050;10", "050;11", "050;12", "051;01", "051;02", "051;03", "051;04", "051;05", "051;06", "051;07", "051;08", "051;09", "051;10", "051;11", "051;12", "052;01", "052;02", "052;03", "052;04", "052;05", "052;06", "052;07", "052;08", "052;09", "052;10", "052;11", "052;12", "053;01", "053;02", "053;03", "053;04", "053;05", "053;06", "053;07", "053;08", "053;09", "053;10", "053;11", "053;12", "054;01", "054;02", "054;03", "054;04", "054;05", "054;06", "054;07", "054;08", "054;09", "054;10", "054;11", "054;12", "055;01", "055;02", "055;03", "055;04", "055;05", "055;06", "055;07", "055;08", "055;09", "055;10", "055;11", "055;12", "056;01", "056;02", "056;03", "056;04", "056;05", "056;06", "056;07", "056;08", "056;09", "056;10", "056;11", "056;12", "057;01", "057;02", "057;03", "057;04", "057;05", "057;06", "057;07", "057;08", "057;09", "057;10", "057;11", "057;12", "058;01", "058;02", "058;03", "058;04", "058;05", "058;06", "058;07", "058;08", "058;09", "058;10", "058;11", "058;12", "059;01", "059;02", "059;03", "059;04", "059;05", "059;06", "059;07", "059;08", "059;09", "059;10", "059;11", "059;12", "060;01", "060;02", "060;03", "060;04", "060;05", "060;06", "060;07", "060;08", "060;09", "060;10", "060;11", "060;12", "061;01", "061;02", "061;03", "061;04", "061;05", "061;06", "061;07", "061;08", "061;09", "061;10", "061;11", "061;12", "062;01", "062;02", "062;03", "062;04", "062;05", "062;06", "062;07", "062;08", "062;09", "062;10", "062;11", "062;12", "063;01", "063;02", "063;03", "063;04", "063;05", "063;06", "063;07", "063;08", "063;09", "063;10", "063;11", "063;12", "064;01", "064;02", "064;03", "064;04", "064;05", "064;06", "064;07", "064;08", "065;01", "065;02", "065;03", "065;04", "065;05", "065;06", "065;07", "065;08", "065;09", "065;10-11", "065;12", "066;01", "066;02", "066;03", "066;04", "066;05", "066;06", "066;07", "066;08", "066;09", "066;10", "066;11-12", "067;01", "067;02", "067;03", "067;04", "067;05", "067;06", "067;07", "067;08", "067;09", "067;10", "067;11", "067;12", "068;01", "068;02", "068;03", "068;04", "068;05", "068;06", "068;07", "068;08", "068;09", "068;10", "068;11-12", "069;01", "069;02", "069;03", "069;04", "069;05", "069;06", "069;07", "069;08", "069;09", "069;10", "069;11-12", "070;01", "070;02", "070;03", "070;04", "070;05", "070;06", "070;07", "070;08", "070;09", "070;10", "070;11-12", "071;01", "071;02", "071;03", "071;04", "071;05", "071;06", "071;07", "071;08", "071;09", "071;10", "071;11-12", "072;01", "072;02", "072;03", "072;04", "072;05", "072;06", "072;07", "072;08", "072;09", "072;10", "072;11-12", "073;01", "073;02", "073;03", "073;04", "073;05", "073;06", "073;07", "073;08", "073;09", "073;10", "073;11-12", "074;01", "074;02", "074;03", "074;04", "074;05", "074;06", "074;07", "074;08", "074;09", "074;10", "074;11-12", "075;01", "075;02", "075;03", "075;04", "075;05", "075;06", "075;07", "075;08", "075;09", "075;10", "075;11-12", "076;01", "076;02", "076;03", "076;04", "076;05", "076;06", "076;07", "076;08", "076;09", "076;10", "076;11-12", "077;01", "077;02", "077;03", "077;04", "077;05", "077;06", "077;07", "077;08", "077;09", "077;10", "077;11-12", "078;01", "078;02", "078;03", "078;04", "078;05", "078;06", "078;07", "078;08", "078;09", "078;10", "078;11-12", "079;01", "079;02", "079;03", "079;04", "079;05", "079;06", "079;07", "079;08", "079;09", "079;10", "079;11-12", "080;01", "080;02", "080;03", "080;04", "080;05", "080;06", "080;07", "080;08-09", "080;10", "080;11", "080;12", "081;01", "081;02", "081;03", "081;04", "081;05", "081;06", "081;07", "081;08", "081;09", "081;10", "081;11-12", "082;01", "082;02", "082;03", "082;04", "082;05", "082;06", "082;07", "082;08", "082;09", "082;10", "082;11-12", "083;01", "083;02", "083;03", "083;04", "083;05", "083;06", "083;07", "083;08", "083;09", "083;10", "083;11", "083;12", "084;01", "084;02", "084;03", "084;04", "084;05", "084;06", "084;07", "084;08", "084;09", "084;10", "084;11", "084;12", "085;01", "085;02", "085;03", "085;04", "085;05", "085;06", "085;07", "085;08", "085;09", "085;10", "085;11", "085;12", "086;01", "086;02", "086;03", "086;04", "086;05", "086;06", "086;07", "086;08", "086;09", "086;10", "086;11", "086;12", "087;01", "087;02", "087;03", "087;04", "087;05", "087;06", "087;07", "087;08", "087;09", "087;10", "087;11", "087;12", "088;01", "088;02", "088;03", "088;04", "088;05", "088;06", "088;07", "088;08", "088;09", "088;10", "088;11", "088;12", "089;01", "089;02", "089;03", "089;04", "089;05", "089;06", "089;07", "089;08", "089;09", "089;10", "089;11", "089;12", "090;01", "090;02", "090;03", "090;04", "090;05", "090;06", "090;07", "090;08", "090;09", "090;10", "090;11", "090;12", "091;01", "091;02", "091;03", "091;04", "091;05", "091;06", "091;07", "091;08", "091;09", "091;10", "091;11", "091;12", "092;01", "092;02", "092;03", "092;04", "092;05", "092;06", "092;07", "092;08", "092;09", "092;10", "092;11", "092;12", "093;01", "093;02", "093;03", "093;04", "093;05", "093;06", "093;07", "093;08", "093;09", "093;10", "093;11", "093;12", "094;01", "094;02", "094;03", "094;04", "094;05", "094;06", "094;07", "094;08", "094;09", "094;10", "094;11", "094;12", "095;01", "095;02", "095;03", "095;04", "095;05", "095;06", "095;07", "095;08", "095;09", "095;10", "095;11", "095;12", "096;01", "096;02", "096;03", "096;04", "096;05", "096;06", "096;07", "096;08", "096;09", "096;10", "096;11", "096;12", "097;01", "097;02", "097;03", "097;04", "097;05", "097;06", "097;07", "097;08", "097;09", "097;10", "097;11", "097;12", "098;01", "098;02", "098;03", "098;04", "098;05", "098;06", "098;07", "098;08", "098;09", "098;10", "098;11", "098;12", "099;01", "099;02", "099;03", "099;04", "099;05", "099;06", "099;07", "099;08", "099;09", "099;10", "099;11", "099;12", "100;01", "100;02", "100;03", "100;04", "100;05", "100;06", "100;07", "100;08", "100;09", "100;10", "100;11", "100;12", "101;01", "101;02", "101;03", "101;04", "101;05", "101;06", "101;07", "101;08", "101;09", "101;10", "101;11", "101;12", "000;00");

$dpart = preg_replace("/^0/", "", $part);
$dpart = preg_replace("/\-0/", "-", $dpart);

$yearMonth = getYearMonth($volume, $part);

echo '<h1 class="clr1 gapBelowSmall">Archive &gt; ' . getMonth($yearMonth['month']) . ' ' . $yearMonth['year'] . ' (Volume ' . intval($volume) . ', Issue ' . $dpart . ')</h1>';

if(!(isValidVolume($volume) && isValidPart($part)))
{
	echo '<span class="aFeature clr2">Invalid URL</span>';
	echo '</div> <!-- cd-container -->';
	echo '</div> <!-- cd-scrolling-bg -->';
	echo '</main> <!-- cd-main-content -->';
	include("include_footer.php");

    exit(1);
}

$query = 'select * from article where volume=\'' . $volume . '\' and part=\'' . $part . '\'';

$result = $db->query($query); 
$num_rows = $result ? $result->num_rows : 0;

if($num_rows > 0)
{
	while($row = $result->fetch_assoc())
	{
		$query3 = 'select feat_name from feature where featid=\'' . $row['featid'] . '\'';
		$result3 = $db->query($query3); 
		$row3 = $result3->fetch_assoc();		
		
		$dpart = preg_replace("/^0/", "", $row['part']);
		$dpart = preg_replace("/\-0/", "-", $dpart);
		
		if($result3){$result3->free();}

		echo '<div class="article">';
		echo ($row3['feat_name'] != '') ? '<div class="gapBelowSmall"><span class="aFeature clr2"><a href="feat_' . $row['featid'] . '.html">' . $row3['feat_name'] . '</a></span></div>' : '';
		echo '	<span class="aTitle"><a target="_blank" href="../Volumes/' . $row['volume'] . '/' . $row['part'] . '/index.djvu?djvuopts&amp;page=' . $row['page'] . '.djvu&amp;zoom=page">' . $row['title'] . '</a></span><br />';
		if($row['authid'] != 0) {

			echo '	<span class="aAuthor itl">by ';
			$authids = preg_split('/;/',$row['authid']);
			$authornames = preg_split('/;/',$row['authorname']);
			$a=0;
			foreach ($authids as $aid) {

				echo '<a href="auth_' . $aid . '.html">' . $authornames[$a] . '</a> ';
				$a++;
			}
			
			echo '	</span>';
		}
		echo '</div>';
	}
}

$val = array_search($volume . ';' . $part, $issue_array);
printPrevNextIssues($issue_array[$val - 1], $issue_array[$val + 1]);

if($result){$result->free();}
$db->close();

?>
			</div> <!-- cd-container -->
		</div> <!-- cd-scrolling-bg -->
	</main> <!-- cd-main-content -->
<?php include("include_footer.php");?>
